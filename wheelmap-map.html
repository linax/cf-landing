<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="Prototipo wheelmap map">
<meta name="keywords" content="Ciudad Fácil, Accesibilidad, teléfono móvil, android, App, Mobile, inclusión">
<meta name="author" content="Ciudad Fácil">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- SITE TITLE -->
<title>Mapa Wheelmap</title>

<div id="map-wheelmap" style="height: 500px; width: 100%;"></div>
<div id="accessibility-cloud-results"></div>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Accessibility Cloud (como en tu ejemplo) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sozialhelden/accessibility-cloud-js@3.2.1/build/example/accessibility.cloud-3.2.1-2350f78a.css">
<script type="text/javascript" async defer src="https://cdn.jsdelivr.net/gh/sozialhelden/accessibility-cloud-js@3.2.1/build/example/accessibility.cloud-3.2.1-21a6710d.min.js"></script>

<script type="text/javascript">
  window.onAccessibilityCloudLoaded = function (AccessibilityCloud) {
    // 1. Inicializa el mapa de OpenStreetMap
    const map = L.map('map-wheelmap').setView([52.5243, 13.4063], 14); // (lat, lon, zoom)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    // 2. Configura Accessibility Cloud (como en tu ejemplo)
    const element = document.querySelector('#accessibility-cloud-results');
    AccessibilityCloud.render(element, {
      token: 'd5429cd685c20a7d0a1166b7d929aa26',
      locale: 'de_DE',
      requestParameters: {
        latitude: 52.5243,
        longitude: 13.4063,
        accuracy: 1000,
        limit: 20,
        filter: 'at-least-partially-accessible-by-wheelchair',
      },
      // 3. Callback cuando se cargan los lugares
      onPlacesLoaded: function(places) {
        places.forEach(place => {
          // Añade un marcador por cada lugar
          if (place.location.latitude && place.location.longitude) {
            const marker = L.marker([place.location.latitude, place.location.longitude])
              .addTo(map)
              .bindPopup(`<strong>${place.name}</strong><br>${place.accessibilityDescription || 'Sin descripción'}`);
          }
        });
      },
    });
  };
</script>
</body>
</html>